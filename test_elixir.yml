steps:

  - script: |
      mkdir -p ./zdevelop/tests
      mkdir -p ./zdevelop/tests/_reports
      mkdir -p ./reports
      mix coveralls.xml --warnings-as-errors
    displayName: Run Tests With Coverage

  - script: |
      find ./_build/test -type f  -name "test-junit-report.xml" -exec cp '{}' "./zdevelop/tests/_reports" \;
      cp "./zdevelop/tests/_reports/test-junit-report.xml" "./reports"
    displayName: Copy JUnit Report

  - script: |
      cp "cover/excoveralls.xml" "./zdevelop/tests/_reports/coverage.xml"
      cp "cover/excoveralls.xml" "./reports/coverage.xml"
    displayName: Copy Coverage Report
